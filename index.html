<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Bright Career Classes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- ‚úÖ Google Search Console Verification -->
<meta name="google-site-verification" content="TWdW0gvrW6T77Qodr3lPEdWIVcW7qwqUvINv-kl6fJU" />

<link rel="icon" type="image/png" href="favicon.png?v=2">
<link rel="apple-touch-icon" href="favicon.png?v=2">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  html{scroll-behavior:smooth}
  body{
    margin:0;font-family:'Poppins',Arial,sans-serif;background:#f4f6fb;position:relative;
  }

  /* watermark */
  body::before{
    content:"";position:fixed;inset:0;
    background-image:url("bcc.png");background-repeat:repeat;background-size:300px 300px;background-position:center;
    opacity:.025;z-index:-1;pointer-events:none;
  }

  header{
    position:sticky;top:0;z-index:9999;
    background:rgba(11,60,93,0.92);
    backdrop-filter:blur(10px);
    box-shadow:0 6px 18px rgba(0,0,0,.18);
    color:#fff;padding:15px;
    display:flex;align-items:center;justify-content:space-between;
  }
  header .left{display:flex;align-items:center;gap:12px}
  header img{width:55px;height:55px;border-radius:50%;background:#fff;padding:3px}
  header h1{font-size:18px;margin:0;line-height:1.2}
  header p{margin:0;font-size:12px;opacity:.95}

  .menu-btn{
    font-size:26px;cursor:pointer;background:rgba(255,255,255,0.15);
    width:42px;height:42px;border-radius:50%;text-align:center;line-height:42px;
    user-select:none;
  }

  .dropdown{
    position:absolute;right:12px;top:70px;background:#fff;width:260px;
    box-shadow:0 0 10px rgba(0,0,0,.25);display:none;z-index:999;border-radius:12px;overflow:hidden
  }
  .dropdown a{
    display:block;padding:12px;text-decoration:none;color:#222;
    border-bottom:1px solid #eee;font-weight:700
  }
  .dropdown a:hover{background:#f3f3f3}

  section{padding:20px}
  .card{
    background:rgba(255,255,255,0.95);
    border:1px solid rgba(11,60,93,0.10);
    padding:20px;border-radius:16px;
    box-shadow:0 12px 30px rgba(0,0,0,0.08);
    margin:15px auto;max-width:980px;
    transition:.25s;
  }
  .card:hover{transform:translateY(-4px)}
  .big-title{font-size:28px;font-weight:800;text-align:center;color:#0b3c5d}
  .moti{text-align:center;font-size:18px;margin-top:10px;line-height:1.7}

  input,select,textarea,button{
    width:100%;padding:11px;margin:8px 0;font-size:16px;
    border-radius:10px;border:1px solid #ddd;box-sizing:border-box
  }
  button{
    background:#0b3c5d;color:#fff;border:none;cursor:pointer;font-weight:800;border-radius:10px
  }
  button:hover{background:#09314b}
  .small-btn{background:#1c6ea4}
  .small-btn:hover{background:#144e75}
  .danger-btn{background:#e74c3c}
  .danger-btn:hover{background:#c0392b}
  .muted{color:#666;font-size:14px}

  .hidden{display:none !important}

  .social-box{text-align:center;margin-top:15px}
  .social-box h3{color:#0b3c5d;margin-bottom:12px}
  .social-link{
    display:flex;align-items:center;gap:12px;justify-content:flex-start;
    max-width:460px;margin:12px auto;padding:12px 14px;border-radius:14px;
    text-decoration:none;background:#f7f9fc;border:1px solid #e6eef7;
    box-shadow:0 3px 8px rgba(0,0,0,0.05);transition:.2s;
  }
  .social-link .icon{
    width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;
    overflow:hidden;background:#fff;border:1px solid #e6eef7;
  }
  .social-link .icon img{width:28px;height:28px;object-fit:contain;display:block}
  .social-link:hover{transform:scale(1.02)}

  .quick-nav{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:18px}
  .quick-nav a{
    padding:10px 16px;background:#0b3c5d;color:#fff;border-radius:12px;text-decoration:none;
    font-weight:800;transition:.2s;
  }
  .quick-nav a:hover{transform:scale(1.03);background:#09314b}

  .pill{
    display:inline-block;padding:7px 12px;border-radius:999px;font-weight:800;font-size:13px;
    border:1px solid #e6eef7;background:#f7f9fc;color:#0b3c5d;
  }
  .pill.green{background:#eaf7ee;border-color:#cfe9d7;color:#1a7f37}
  .pill.red{background:#ffeceb;border-color:#ffd0cb;color:#b72212}

  /* ID CARD */
  .idcard-wrap{
    display:none;margin-top:15px;padding:16px;border-radius:16px;background:#f7f9fc;border:1px solid #e6eef7;
  }
  .idcard{
    width:100%;max-width:420px;margin:0 auto;border-radius:18px;overflow:hidden;background:#fff;
    border:1px solid rgba(0,0,0,0.08);box-shadow:0 14px 30px rgba(0,0,0,0.10);
  }
  .id-top{
    background:linear-gradient(90deg,#0b3c5d,#1c6ea4);
    padding:14px;color:#fff;display:flex;gap:12px;align-items:center;
  }
  .id-top img{width:52px;height:52px;border-radius:14px;background:#fff;padding:4px}
  .id-top .t1{font-weight:900;font-size:16px;line-height:1.1}
  .id-top .t2{font-size:12px;opacity:.95;margin-top:3px}

  .id-body{padding:14px;display:flex;gap:14px;align-items:flex-start;justify-content:space-between}
  .id-left{flex:1}
  .id-row{font-size:14px;margin:6px 0;color:#222}
  .id-row b{color:#0b3c5d}
  .student-id{
    margin-top:10px;padding:8px 12px;border-radius:12px;background:#eaf2ff;border:1px solid #d6e6ff;
    display:inline-block;font-weight:900;color:#0b3c5d;
  }
  .qr-box{
    width:120px;min-width:120px;height:120px;border-radius:16px;background:#fff;border:1px solid #eee;
    display:flex;align-items:center;justify-content:center;
  }
  .id-footer{padding:12px 14px;background:#fff;border-top:1px solid #eee;font-size:12px;color:#666;text-align:center}

  /* Floating */
  .call-float{
    position:fixed;right:15px;bottom:25px;background:#007bff;color:#fff;
    padding:12px 16px;border-radius:50px;text-decoration:none;font-weight:900;
    box-shadow:0 6px 15px rgba(0,0,0,.35);z-index:5000
  }
  .whatsapp-float-right{
    position:fixed;right:15px;bottom:90px;background:#25D366;color:#fff;
    padding:12px 16px;border-radius:50px;text-decoration:none;font-weight:900;
    box-shadow:0 6px 15px rgba(0,0,0,.35);z-index:5000;display:flex;gap:10px;align-items:center
  }
  .whatsapp-float-right img{width:24px;height:24px;object-fit:contain}
  .pulse{animation:pulseGlow 2s infinite}
  @keyframes pulseGlow{
    0%{box-shadow:0 0 0 0 rgba(37,211,102,0.7)}
    70%{box-shadow:0 0 0 18px rgba(37,211,102,0)}
    100%{box-shadow:0 0 0 0 rgba(37,211,102,0)}
  }

  footer{margin-top:40px;padding:18px;text-align:center;color:#555;font-size:14px}

  @media(max-width:768px){
    header h1{font-size:16px}
    .big-title{font-size:22px}
    .moti{font-size:16px}
    .dropdown{width:230px}
  }
</style>
</head>

<body>

<header>
  <div class="left">
    <img src="bcc.png" alt="Logo">
    <div>
      <h1>Bright Career Classes</h1>
      <p>Learn Today ‚Ä¢ Lead Tomorrow</p>
    </div>
  </div>

  <div class="menu-btn" onclick="toggleMenu()">‚ãÆ</div>

  <div class="dropdown" id="menu">
    <a href="#studentPortal" onclick="closeMenu()">üîê Student Portal</a>
    <a href="#home" onclick="closeMenu()">üè† Home</a>
    <a href="#about" onclick="closeMenu()">‚Ñπ About</a>
    <a href="#admission" onclick="closeMenu()">üìù Admission</a>
    <a href="#myAccount" onclick="closeMenu()">üë§ My Account</a>
    <a href="#adminLogin" onclick="closeMenu()">‚öô Admin Login</a>
  </div>
</header>

<!-- ‚úÖ STUDENT PORTAL (Login/Signup compulsory) -->
<section id="studentPortal">
  <div class="card">
    <div class="big-title">Student Portal Login</div>
    <p class="muted" style="text-align:center;margin-top:8px;">
      ‚úÖ Website access only after login/signup
    </p>

    <div id="authBox">

      <h3 style="color:#0b3c5d;margin-bottom:6px;">Login</h3>
      <input id="loginUser" placeholder="Email or Mobile">
      <input id="loginPass" type="password" placeholder="Password">
      <button onclick="loginStudent()">Login</button>

      <p class="muted" style="text-align:center;margin:10px 0;">OR</p>

      <h3 style="color:#0b3c5d;margin-bottom:6px;">Create New Account</h3>
      <input id="regName" placeholder="Full Name">
      <input id="regEmail" placeholder="Email (example@gmail.com)">
      <input id="regPhone" placeholder="Mobile (10 digits)"
             maxlength="10"
             oninput="this.value=this.value.replace(/[^0-9]/g,'');">
      <input id="regPass" type="password" placeholder="Create Password (min 4)">
      <button class="small-btn" onclick="registerStudent()">Create Account</button>

      <div class="card" style="background:#f7f9fc;border:1px solid #e6eef7;box-shadow:none;">
        <b>‚ö†Ô∏è OTP / Google Login Note:</b>
        <div class="muted" style="margin-top:6px;">
          OTP/Google login needs backend (Firebase). Abhi demo mode me manual verification ‚úÖ
        </div>
      </div>
    </div>

    <div id="authSuccess" class="hidden">
      <h3 style="color:#0b3c5d;margin-top:0;">‚úÖ Logged in Successfully</h3>
      <p class="muted">Now you can access full website.</p>
      <button onclick="goHome()">Go to Home</button>
      <button class="danger-btn" onclick="logoutStudent()">Logout</button>
    </div>

  </div>
</section>

<!-- ‚úÖ MAIN WEBSITE CONTENT (LOCKED UNTIL LOGIN) -->
<section id="home" class="hidden">
  <div class="card">
    <div class="big-title">Welcome to Bright Career Classes</div>

    <div class="moti">
      ‚úÖ ‚ÄúDream Big. Work Hard. Achieve Excellence.‚Äù<br>
      ‚úÖ ‚ÄúYour Success is Our Mission.‚Äù<br>
      ‚úÖ ‚ÄúConsistency + Practice = Top Results.‚Äù<br><br>
      üìö Classes: <b>6 to 12</b> (CBSE ‚Ä¢ ICSE/ISC ‚Ä¢ UP Board)
    </div>

    <div style="
      margin-top:15px;
      padding:12px;
      border-radius:14px;
      background:linear-gradient(90deg,#0b3c5d,#1c6ea4);
      color:white;
      text-align:center;
      font-weight:800;
    ">
      üéØ Demo Class Available ‚Ä¢ Weekly Tests ‚Ä¢ Best Notes Support ‚úÖ
    </div>

    <div class="quick-nav">
      <a href="#admission">üìù Admission</a>
      <a href="#myAccount">üë§ My Account</a>
      <a href="#adminLogin">‚öô Admin</a>
    </div>

    <hr>

    <div class="social-box">
      <h3>Follow & Learn Online</h3>

      <a class="social-link" target="_blank"
         href="https://youtube.com/@brightcareerclasses-1?si=QNgL_2sOHDz6l-Vy">
        <span class="icon"><img src="youtube.png" alt="YouTube"></span>
        <div class="text">
          <b>YouTube Classes</b>
          <small>@brightcareerclasses-1</small>
        </div>
      </a>

      <a class="social-link" target="_blank"
         href="https://instagram.com/brightcareerclasses0701">
        <span class="icon"><img src="instagram.png" alt="Instagram"></span>
        <div class="text">
          <b>Instagram</b>
          <small>brightcareerclasses0701</small>
        </div>
      </a>
    </div>

  </div>
</section>

<section id="about" class="hidden">
  <div class="card">
    <h2>About Our Classes</h2>

    <p style="font-size:16px;line-height:1.8;">
      Bright Career Classes is committed to providing quality education with strong basics, discipline,
      and confidence. We focus on concept clarity, regular practice, and exam-oriented preparation
      for all boards (CBSE, ICSE/ISC, UP Board).
    </p>

    <p style="font-size:16px;line-height:1.8;">
      ‚úÖ Experienced Teachers <br>
      ‚úÖ Demo Class Available <br>
      ‚úÖ Weekly Tests & Revision <br>
      ‚úÖ Special Focus for Class 11 & 12 (PCM / PCB)
    </p>

    <hr>
    <p><b>Director:</b> Deepak Rai</p>
    <p><b>Administrator:</b> Amit Rai</p>
    <p><b>Contact:</b> 9140466780</p>
    <p><b>Email:</b> <a href="mailto:brightclasses78@gmail.com">brightclasses78@gmail.com</a></p>
  </div>
</section>

<!-- ‚úÖ ADMISSION FORM (ONLY LOGIN USER CAN SUBMIT) -->
<section id="admission" class="hidden">
  <div class="card">
    <h2>Admission Form</h2>
    <p class="muted">‚úÖ Submit admission request ‚Üí Admin approval required</p>

    <input id="sname" placeholder="Student Name">

    <select id="sboard">
      <option value="">Select Board</option>
      <option value="CBSE">CBSE</option>
      <option value="ICSE/ISC">ICSE/ISC</option>
      <option value="UP BOARD">UP BOARD</option>
    </select>

    <select id="sclass">
      <option value="">Select Class</option>
      <option>6</option><option>7</option><option>8</option>
      <option>9</option><option>10</option><option>11</option><option>12</option>
    </select>

    <!-- ‚úÖ Phone only numbers + exact 10 digits -->
    <input id="sphone"
           type="tel"
           inputmode="numeric"
           pattern="[0-9]{10}"
           maxlength="10"
           placeholder="Mobile Number (10 digits)"
           oninput="this.value=this.value.replace(/[^0-9]/g,'');">

    <input id="semail" placeholder="Email (example@gmail.com)">
    <textarea id="saddress" placeholder="Address"></textarea>

    <button onclick="submitAdmission()">Submit Admission Request</button>

    <div class="card" style="background:#f7f9fc;border:1px solid #e6eef7;box-shadow:none;">
      <b>Status:</b>
      <span id="admissionStatusText" class="pill red">Not Submitted</span>
      <div class="muted" style="margin-top:6px;">
        ‚úÖ Admin approve karega tabhi Admission No + ID Card banega
      </div>
    </div>
  </div>
</section>

<!-- ‚úÖ MY ACCOUNT -->
<section id="myAccount" class="hidden">
  <div class="card">
    <h2>üë§ My Account</h2>

    <div id="accInfo" class="card" style="background:#f7f9fc;border:1px solid #e6eef7;box-shadow:none;">
      Loading...
    </div>

    <div id="accAdmissionBox" class="card" style="background:#fff;border:1px solid #eee;box-shadow:none;">
      <h3 style="margin-top:0;color:#0b3c5d;">üìå Admission Timeline</h3>
      <div id="accAdmissionTimeline" class="muted">No admission request yet.</div>
    </div>

    <!-- ‚úÖ ID Card only after Approved -->
    <div id="idCardWrap" class="idcard-wrap">
      <h3 style="text-align:center;color:#0b3c5d;margin-top:0;">‚úÖ Your ID Card (Approved)</h3>

      <div id="idCard" class="idcard">
        <div class="id-top">
          <img src="bcc.png" alt="Logo">
          <div>
            <div class="t1">Bright Career Classes</div>
            <div class="t2">Official Student ID Card</div>
          </div>
        </div>

        <div class="id-body">
          <div class="id-left">
            <div class="id-row"><b>Name:</b> <span id="cardName">-</span></div>
            <div class="id-row"><b>Board:</b> <span id="cardBoard">-</span></div>
            <div class="id-row"><b>Class:</b> <span id="cardClass">-</span></div>
            <div class="id-row"><b>Phone:</b> <span id="cardPhone">-</span></div>
            <div class="id-row"><b>Email:</b> <span id="cardEmail">-</span></div>

            <div class="id-row"><b>Admission No:</b> <span id="cardAdmNo">-</span></div>

            <div class="student-id">ID: <span id="cardID">BCC-000000</span></div>
          </div>

          <div class="qr-box">
            <div id="qrBox"></div>
          </div>
        </div>

        <div class="id-footer">
          ‚úÖ Scan QR to verify ‚Ä¢ Bright Career Classes
        </div>
      </div>

      <button style="margin-top:12px;" onclick="downloadIDCardPNG()">‚¨á Download ID Card (PNG)</button>
      <button class="small-btn" onclick="openWhatsappWithID()">üí¨ Send ID + Details on WhatsApp</button>
    </div>

    <button class="danger-btn" onclick="logoutStudent()">Logout</button>
  </div>
</section>

<!-- ‚úÖ ADMIN LOGIN -->
<section id="adminLogin">
  <div class="card">
    <h2>‚öô Admin Login</h2>
    <p class="muted">‚úÖ Only Admin can approve admission</p>

    <input id="adminPass" type="password" placeholder="Admin Password">
    <button onclick="adminLogin()">Login as Admin</button>

    <div id="adminPanel" class="hidden">
      <hr>
      <h2 style="margin-top:0;color:#0b3c5d;">‚úÖ Admin Panel</h2>
      <button class="danger-btn" onclick="adminLogout()">Logout Admin</button>

      <hr>
      <h3 style="color:#0b3c5d;margin-bottom:6px;">Admissions (Serial Wise)</h3>
      <div class="muted">‚úÖ Pending requests ko approve karo</div>

      <div id="adminAdmissionsList" style="margin-top:10px;">No admissions yet.</div>
    </div>
  </div>
</section>

<footer class="hidden" id="footerMain">
  ¬© 2026 Bright Career Classes ‚Ä¢ All Rights Reserved ‚úÖ
</footer>

<a class="call-float hidden" id="callBtn" href="tel:+919140466780">üìû Call Us</a>
<a class="whatsapp-float-right pulse hidden" id="waBtn"
   target="_blank"
   href="https://wa.me/919140466780?text=Hello%20Bright%20Career%20Classes,%20I%20want%20admission">
  <img src="watsapp.png" alt="WhatsApp">
  <span>Admission on WhatsApp</span> üí¨
</a>

<!-- ‚úÖ QR + Download -->
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
/* =========================
   ‚úÖ BASIC UTILITIES
========================= */
function toggleMenu(){
  const m = document.getElementById("menu");
  m.style.display = (m.style.display === "block") ? "none" : "block";
}
function closeMenu(){ document.getElementById("menu").style.display = "none"; }

function $(id){ return document.getElementById(id); }

function isValidEmail(email){
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}
function isValidPhone(phone){
  return /^[0-9]{10}$/.test(phone);
}

function loadDB(key, fallback){
  try{
    const v = JSON.parse(localStorage.getItem(key) || "null");
    return v ? v : fallback;
  }catch(e){
    return fallback;
  }
}
function saveDB(key, data){
  localStorage.setItem(key, JSON.stringify(data));
}

/* =========================
   ‚úÖ AUTH (Students)
========================= */
// users: [{id, name, email, phone, pass}]
function getUsers(){ return loadDB("bcc_users", []); }
function setUsers(u){ saveDB("bcc_users", u); }

function setSession(userId){
  localStorage.setItem("bcc_session_user", userId);
}
function getSession(){
  return localStorage.getItem("bcc_session_user");
}
function clearSession(){
  localStorage.removeItem("bcc_session_user");
}

function findUserByLogin(loginText){
  const users = getUsers();
  return users.find(u => u.email.toLowerCase() === loginText.toLowerCase() || u.phone === loginText);
}

function registerStudent(){
  const name = $("regName").value.trim();
  const email = $("regEmail").value.trim();
  const phone = $("regPhone").value.trim();
  const pass = $("regPass").value.trim();

  if(!name || !email || !phone || !pass){
    alert("‚ùå Please fill all fields");
    return;
  }
  if(!isValidEmail(email)){
    alert("‚ùå Enter valid email");
    return;
  }
  if(!isValidPhone(phone)){
    alert("‚ùå Enter valid 10-digit mobile number");
    return;
  }
  if(pass.length < 4){
    alert("‚ùå Password minimum 4 characters");
    return;
  }

  let users = getUsers();

  if(users.some(u => u.email.toLowerCase() === email.toLowerCase())){
    alert("‚ùå Email already registered");
    return;
  }
  if(users.some(u => u.phone === phone)){
    alert("‚ùå Mobile already registered");
    return;
  }

  const newUser = {
    id: "U" + Date.now(),
    name, email, phone,
    pass
  };

  users.push(newUser);
  setUsers(users);

  // auto login
  setSession(newUser.id);
  alert("‚úÖ Account Created Successfully!");
  refreshUI();
}

function loginStudent(){
  const login = $("loginUser").value.trim();
  const pass = $("loginPass").value.trim();

  if(!login || !pass){
    alert("‚ùå Enter login + password");
    return;
  }

  const user = findUserByLogin(login);
  if(!user){
    alert("‚ùå Account not found");
    return;
  }
  if(user.pass !== pass){
    alert("‚ùå Wrong password");
    return;
  }

  setSession(user.id);
  alert("‚úÖ Login Successful");
  refreshUI();
}

function logoutStudent(){
  clearSession();
  alert("Logged out ‚úÖ");
  refreshUI();
}

/* =========================
   ‚úÖ Admissions System
========================= */
/*
admissions: [
  {serial, userId, name, board, cls, phone, email, address, status, admissionNo, studentId, time}
]
*/
function getAdmissions(){ return loadDB("bcc_admissions", []); }
function setAdmissions(a){ saveDB("bcc_admissions", a); }

// ‚úÖ Unique Student ID by phone (same phone => same id)
function getOrCreateStudentID(name, phone){
  let db = loadDB("bcc_students", {});
  if(db[phone]) return db[phone].id;

  const num = Math.floor(100000 + Math.random()*900000);
  const sid = "BCC-" + num;

  db[phone] = { id: sid, name: name };
  saveDB("bcc_students", db);
  return sid;
}

// ‚úÖ Random admission number after approval
function makeAdmissionNo(){
  // Example: ADM-482913
  const num = Math.floor(100000 + Math.random()*900000);
  return "ADM-" + num;
}

function getMyAdmission(userId){
  const all = getAdmissions();
  return all.find(a => a.userId === userId) || null;
}

function submitAdmission(){
  const userId = getSession();
  if(!userId){
    alert("‚ùå Please login first");
    return;
  }

  const name = $("sname").value.trim();
  const board = $("sboard").value.trim();
  const cls = $("sclass").value.trim();
  const phone = $("sphone").value.trim();
  const email = $("semail").value.trim();
  const address = $("saddress").value.trim();

  if(!name || !board || !cls || !phone || !email){
    alert("‚ùå Fill required fields (Name, Board, Class, Mobile, Email)");
    return;
  }
  if(!isValidPhone(phone)){
    alert("‚ùå Mobile must be exactly 10 digits (numbers only)");
    return;
  }
  if(!isValidEmail(email)){
    alert("‚ùå Enter valid email");
    return;
  }

  // extra safety: user phone/email must match account (verification)
  const me = getUsers().find(u => u.id === userId);
  if(!me){
    alert("‚ùå Login error, please login again");
    logoutStudent();
    return;
  }
  if(me.phone !== phone){
    alert("‚ùå Mobile must match your account mobile!");
    return;
  }
  if(me.email.toLowerCase() !== email.toLowerCase()){
    alert("‚ùå Email must match your account email!");
    return;
  }

  // prevent multiple admissions
  const existing = getMyAdmission(userId);
  if(existing){
    alert("‚úÖ Your admission request already submitted. Admin approval pending.");
    refreshAccount();
    return;
  }

  let all = getAdmissions();
  const serial = all.length + 1;

  const studentId = getOrCreateStudentID(name, phone);

  all.push({
    serial,
    userId,
    name, board, cls,
    phone, email,
    address,
    status: "PENDING",
    admissionNo: "",
    studentId,
    time: new Date().toLocaleString()
  });

  setAdmissions(all);

  $("admissionStatusText").className = "pill red";
  $("admissionStatusText").textContent = "Pending Approval";

  alert("‚úÖ Admission Submitted! Admin approval required.");

  // optional: send message to owner (pending info)
  let msg =
    "üìò *New Admission Request (PENDING)*%0A%0A" +
    "S.No: " + serial + "%0A" +
    "üë§ Name: " + name + "%0A" +
    "üè´ Board: " + board + "%0A" +
    "üìö Class: " + cls + "%0A" +
    "üìû Phone: " + phone + "%0A" +
    "‚úâÔ∏è Email: " + email + "%0A" +
    "üìç Address: " + (address || "-") + "%0A%0A" +
    "‚úÖ Admin panel me approve kare.";

  window.open("https://wa.me/919140466780?text=" + msg, "_blank");

  refreshAccount();
}

/* =========================
   ‚úÖ ADMIN
========================= */
let ADMIN_PASSWORD = "amitrai7074"; 
// ‚úÖ ‡§§‡•Å‡§Æ ‡§Ö‡§™‡§®‡§æ password ‡§Ø‡§π‡§æ‡§Å set ‡§ï‡§∞ ‡§¶‡•á‡§®‡§æ:
// example: ADMIN_PASSWORD = "amit6204";

function adminLogin(){
  const pass = $("adminPass").value.trim();

  if(!ADMIN_PASSWORD){
    alert("‚ö†Ô∏è Admin password not set in code.\nPlease add ADMIN_PASSWORD inside script.");
    return;
  }

  if(pass === ADMIN_PASSWORD){
    localStorage.setItem("bcc_admin_session","1");
    alert("‚úÖ Admin login successful");
    refreshAdmin();
  }else{
    alert("‚ùå Wrong admin password");
  }
}

function adminLogout(){
  localStorage.removeItem("bcc_admin_session");
  alert("Admin logged out ‚úÖ");
  refreshAdmin();
}

function isAdmin(){
  return localStorage.getItem("bcc_admin_session") === "1";
}

function approveAdmission(serial){
  if(!isAdmin()){
    alert("‚ùå Admin not logged in");
    return;
  }

  let all = getAdmissions();
  const idx = all.findIndex(a => a.serial === serial);
  if(idx === -1){ alert("Not found"); return; }

  if(all[idx].status === "APPROVED"){
    alert("Already approved ‚úÖ");
    return;
  }

  // generate admission no
  const admNo = makeAdmissionNo();
  all[idx].status = "APPROVED";
  all[idx].admissionNo = admNo;

  setAdmissions(all);

  alert("‚úÖ Approved! Admission No generated: " + admNo);

  // WhatsApp owner message (approved)
  const a = all[idx];
  let msg =
    "‚úÖ *Admission APPROVED*%0A%0A" +
    "S.No: " + a.serial + "%0A" +
    "üÜî Admission No: *" + a.admissionNo + "*%0A" +
    "üë§ Name: " + a.name + "%0A" +
    "üìö Class: " + a.cls + "%0A" +
    "üè´ Board: " + a.board + "%0A" +
    "üìû Phone: " + a.phone + "%0A%0A" +
    "‚úÖ Student portal me ID Card available.";

  window.open("https://wa.me/919140466780?text=" + msg, "_blank");

  refreshAdmin();
  refreshAccount();
}

function refreshAdmin(){
  const panel = $("adminPanel");
  if(isAdmin()){
    panel.classList.remove("hidden");
    renderAdminAdmissions();
  }else{
    panel.classList.add("hidden");
  }
}

function renderAdminAdmissions(){
  const all = getAdmissions();
  if(all.length === 0){
    $("adminAdmissionsList").innerHTML = "No admissions yet.";
    return;
  }

  let html = "";
  all.forEach(a=>{
    const statusPill = a.status === "APPROVED"
      ? `<span class="pill green">APPROVED</span>`
      : `<span class="pill red">PENDING</span>`;

    html += `
      <div style="border:1px solid #eee;padding:12px;border-radius:14px;margin:10px 0;background:#fff;">
        <b>${a.serial}. ${a.name}</b> ${statusPill}<br>
        Board: ${a.board} | Class: ${a.cls}<br>
        Phone: ${a.phone}<br>
        Email: ${a.email}<br>
        Admission No: <b>${a.admissionNo ? a.admissionNo : "-"}</b><br>
        <small style="color:#666;">${a.time}</small><br><br>

        ${
          a.status === "PENDING"
            ? `<button class="small-btn" onclick="approveAdmission(${a.serial})">‚úÖ Approve</button>`
            : `<button disabled style="opacity:.6;cursor:not-allowed;">Already Approved</button>`
        }
      </div>
    `;
  });

  $("adminAdmissionsList").innerHTML = html;
}

/* =========================
   ‚úÖ STUDENT ACCOUNT UI
========================= */
function refreshAccount(){
  const userId = getSession();
  if(!userId){
    $("accInfo").innerHTML = `<b>‚ùå Not logged in</b>`;
    $("accAdmissionTimeline").textContent = "Login first.";
    $("idCardWrap").style.display = "none";
    return;
  }

  const me = getUsers().find(u => u.id === userId);
  if(!me){
    $("accInfo").innerHTML = `<b>‚ùå User not found</b>`;
    return;
  }

  $("accInfo").innerHTML = `
    <b>Name:</b> ${me.name}<br>
    <b>Email:</b> ${me.email}<br>
    <b>Mobile:</b> ${me.phone}<br>
    <div style="margin-top:10px;">
      <span class="pill green">Account Verified (Demo)</span>
    </div>
  `;

  const adm = getMyAdmission(userId);
  if(!adm){
    $("accAdmissionTimeline").innerHTML = `
      <span class="pill red">No Admission Request</span><br>
      <div class="muted" style="margin-top:6px;">Go to Admission form and submit ‚úÖ</div>
    `;
    $("idCardWrap").style.display = "none";
    $("admissionStatusText").className = "pill red";
    $("admissionStatusText").textContent = "Not Submitted";
    return;
  }

  if(adm.status === "PENDING"){
    $("accAdmissionTimeline").innerHTML = `
      <span class="pill red">Pending Approval</span><br>
      <div class="muted" style="margin-top:6px;">
        ‚úÖ Admin approval required. After approval you will get Admission No.
      </div>
    `;
    $("idCardWrap").style.display = "none";
    $("admissionStatusText").className = "pill red";
    $("admissionStatusText").textContent = "Pending Approval";
    return;
  }

  // APPROVED
  $("accAdmissionTimeline").innerHTML = `
    <span class="pill green">Approved ‚úÖ</span><br>
    <div style="margin-top:8px;">
      <b>Admission No:</b> ${adm.admissionNo}<br>
      <b>Serial No:</b> ${adm.serial}
    </div>
  `;
  $("admissionStatusText").className = "pill green";
  $("admissionStatusText").textContent = "Approved ‚úÖ";

  // Now show ID Card (only if admission no exists)
  if(!adm.admissionNo){
    $("idCardWrap").style.display = "none";
    return;
  }

  // Student ID must be based on admission no (your twist)
  // ‚úÖ We'll make ID = "BCC-" + last 6 digits of admission no random part
  const studentID = "BCC-" + adm.admissionNo.replace("ADM-","");

  $("cardName").textContent = adm.name;
  $("cardBoard").textContent = adm.board;
  $("cardClass").textContent = adm.cls;
  $("cardPhone").textContent = adm.phone;
  $("cardEmail").textContent = adm.email;
  $("cardAdmNo").textContent = adm.admissionNo;
  $("cardID").textContent = studentID;

  // QR includes admission no
  const qrData =
    "Bright Career Classes | Verified Student\n" +
    "Admission No: " + adm.admissionNo + "\n" +
    "Student ID: " + studentID + "\n" +
    "Name: " + adm.name + "\n" +
    "Board: " + adm.board + "\n" +
    "Class: " + adm.cls + "\n" +
    "Phone: " + adm.phone + "\n" +
    "Email: " + adm.email;

  $("qrBox").innerHTML = "";
  new QRCode($("qrBox"), { text: qrData, width: 100, height: 100 });

  $("idCardWrap").style.display = "block";
}

/* ‚úÖ Download ID Card */
function downloadIDCardPNG(){
  const node = $("idCard");
  html2canvas(node, {scale: 2}).then(canvas=>{
    const link = document.createElement("a");
    link.download = "BCC_IDCard.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
}

/* ‚úÖ WhatsApp message with all details */
function openWhatsappWithID(){
  const userId = getSession();
  if(!userId){ alert("Login first"); return; }

  const adm = getMyAdmission(userId);
  if(!adm || adm.status !== "APPROVED"){
    alert("‚ùå Admin approval required");
    return;
  }

  const studentID = "BCC-" + adm.admissionNo.replace("ADM-","");

  let msg =
    "‚úÖ *Bright Career Classes - Verified Student*%0A%0A" +
    "üÜî Admission No: *" + adm.admissionNo + "*%0A" +
    "ü™™ Student ID: *" + studentID + "*%0A%0A" +
    "üë§ Name: " + adm.name + "%0A" +
    "üè´ Board: " + adm.board + "%0A" +
    "üìö Class: " + adm.cls + "%0A" +
    "üìû Phone: " + adm.phone + "%0A" +
    "‚úâÔ∏è Email: " + adm.email + "%0A%0A" +
    "‚úÖ ID Card image downloaded. Attach & send ‚úÖ";

  // Auto-download ID Card too (so you can attach)
  downloadIDCardPNG();

  window.open("https://wa.me/919140466780?text=" + msg, "_blank");
}

/* =========================
   ‚úÖ UI LOCK/UNLOCK
========================= */
function showMainSections(isLoggedIn){
  const ids = ["home","about","admission","myAccount"];
  ids.forEach(id=>{
    const el = document.getElementById(id);
    if(isLoggedIn) el.classList.remove("hidden");
    else el.classList.add("hidden");
  });

  // footer + float buttons only after login
  $("footerMain").classList.toggle("hidden", !isLoggedIn);
  $("callBtn").classList.toggle("hidden", !isLoggedIn);
  $("waBtn").classList.toggle("hidden", !isLoggedIn);
}

function goHome(){
  location.href = "#home";
}

/* =========================
   ‚úÖ INIT / REFRESH UI
========================= */
function refreshUI(){
  const userId = getSession();
  const loggedIn = !!userId;

  // auth boxes
  $("authBox").classList.toggle("hidden", loggedIn);
  $("authSuccess").classList.toggle("hidden", !loggedIn);

  showMainSections(loggedIn);

  if(loggedIn){
    refreshAccount();
  }else{
    // reset admission status
    $("admissionStatusText").className = "pill red";
    $("admissionStatusText").textContent = "Not Submitted";
  }

  refreshAdmin();
}

refreshUI();
</script>

</body>
</html>

